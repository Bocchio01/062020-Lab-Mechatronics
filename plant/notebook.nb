(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     41758,       1126]
NotebookOptionsPosition[     39686,       1087]
NotebookOutlinePosition[     40151,       1105]
CellTagsIndexPosition[     40108,       1102]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"MagLev", " ", "modelling"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{
    "This", " ", "notebook", " ", "is", " ", "used", " ", "to", " ", "derive",
      " ", "a", " ", "full", " ", "model", " ", "for", " ", "the", " ", 
     "laboratory", " ", "MagLev", " ", "system", " ", "provided", " ", 
     RowBox[{"by", " ", "'"}], 
     RowBox[{"Inteco", "'"}]}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"Date", ":", " ", 
     RowBox[{
      RowBox[{"29", "/", "09"}], "/", "2024"}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]}]], "Input",
 CellChangeTimes->{{3.918898458634508*^9, 3.918898486800106*^9}, 
   3.9188987409561615`*^9, 3.9188995043948*^9, {3.918903008613415*^9, 
   3.9189030359557*^9}, {3.921713678140389*^9, 3.921713679084944*^9}, {
   3.936459141762804*^9, 3.936459156799362*^9}, {3.9365972909192066`*^9, 
   3.9365974264832573`*^9}, 3.93659751156452*^9, {3.93659763979883*^9, 
   3.9365976737427425`*^9}, {3.936597826315367*^9, 3.9365978396374283`*^9}, {
   3.936600890123008*^9, 3.936600893104759*^9}},
 CellLabel->
  "In[221]:=",ExpressionUUID->"c60eeeea-1f42-da4b-ad85-56602cc04086"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Functions", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"displayGrid", "[", 
     RowBox[{"DOFs_List", ",", "args___"}], "]"}], ":=", 
    RowBox[{"Grid", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{
          RowBox[{"List", "@@", 
           RowBox[{
            RowBox[{"{", "args", "}"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "i"}], "]"}], "]"}]}], ",", 
          RowBox[{"DOFs", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "DOFs", "]"}]}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Frame", "->", "All"}], ",", 
      RowBox[{"Spacings", "->", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}]}], ",", 
      RowBox[{"Alignment", "->", "Left"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"displayEquations", "[", "equations_List", "]"}], ":=", 
    RowBox[{"equations", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Derivative", "[", "1", "]"}], "[", "x_", "]"}], ":>", 
        RowBox[{"OverDot", "[", 
         RowBox[{"x", ",", "1"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Derivative", "[", "2", "]"}], "[", "x_", "]"}], ":>", 
        RowBox[{"OverDot", "[", 
         RowBox[{"x", ",", "2"}], "]"}]}]}], "}"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.936600896226085*^9, 3.93660098211247*^9}, 
   3.936601047078678*^9, {3.936601120062895*^9, 3.936601137074497*^9}},
 CellLabel->
  "In[222]:=",ExpressionUUID->"9761a00d-313e-ad4d-8777-6aab98ffa736"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Lagrangian", " ", "equation", " ", "solver"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    TemplateBox[<|"boxes" -> FormBox[
        RowBox[{
          FractionBox[
           StyleBox["d", "TI"], 
           RowBox[{
             StyleBox["d", "TI"], 
             StyleBox["t", "TI"]}]], 
          RowBox[{"(", 
            FractionBox[
             RowBox[{"\[PartialD]", 
               StyleBox["T", "TI"]}], 
             RowBox[{"\[PartialD]", 
               OverscriptBox[
                StyleBox["u", "TI"], "."]}]], ")"}], "-", 
          FractionBox[
           RowBox[{"\[PartialD]", 
             StyleBox["T", "TI"]}], 
           RowBox[{"\[PartialD]", 
             StyleBox["u", "TI"]}]], "+", 
          FractionBox[
           RowBox[{"\[PartialD]", 
             StyleBox["Q", "TI"]}], 
           RowBox[{"\[PartialD]", 
             OverscriptBox[
              StyleBox["u", "TI"], "."]}]], "+", 
          FractionBox[
           RowBox[{"\[PartialD]", 
             StyleBox["U", "TI"]}], 
           RowBox[{"\[PartialD]", 
             StyleBox["u", "TI"]}]], "\[LongEqual]", 
          StyleBox["Q", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
      "\\frac{d}{dt} \\left( \\frac{\\partial T}{\\partial \\dot{u}} \\right) \
- \\frac{\\partial T}{\\partial u} + \\frac{\\partial Q}{\\partial \\dot{u}} \
+ \\frac{\\partial U}{\\partial u} = Q", "state" -> "Boxes"|>,
     "TeXAssistantTemplate"], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LagrangianEquations", "[", 
      RowBox[{"T_", ",", "Q_", ",", 
       RowBox[{"U_", ":", "0"}], ",", "DOFs_List"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"T", ",", 
              RowBox[{"D", "[", 
               RowBox[{"#", ",", "t"}], "]"}]}], "]"}], ",", "t"}], "]"}], 
          "-", 
          RowBox[{"D", "[", 
           RowBox[{"T", ",", "#"}], "]"}], "+", " ", 
          RowBox[{"D", "[", 
           RowBox[{"Q", ",", 
            RowBox[{"D", "[", 
             RowBox[{"#", ",", "t"}], "]"}]}], "]"}], "+", 
          RowBox[{"D", "[", 
           RowBox[{"U", ",", "#"}], "]"}]}], "==", "0"}], ")"}], "&"}], "/@", 
      "DOFs"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.936591803752815*^9, 3.936591838988478*^9}, {
   3.936591888761275*^9, 3.9365918929493885`*^9}, {3.936593172242047*^9, 
   3.93659319184132*^9}, {3.936593538005539*^9, 3.936593550357828*^9}, {
   3.9365938991170025`*^9, 3.936593998079235*^9}, {3.936594074689411*^9, 
   3.936594093661245*^9}, {3.936594139518896*^9, 3.93659416758876*^9}, {
   3.93659438611656*^9, 3.9365943929881306`*^9}, 3.936595135983898*^9, 
   3.93659519661597*^9, {3.936595264941086*^9, 3.936595354524206*^9}, {
   3.936595450384445*^9, 3.936595453890972*^9}, {3.9365972508442154`*^9, 
   3.936597251406651*^9}, {3.9391252856133423`*^9, 3.939125316649868*^9}},
 CellLabel->
  "In[224]:=",ExpressionUUID->"7e5f123e-8ee5-eb4a-ba72-1e70e4cb4e67"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", 
   RowBox[{"Inductance", " ", "equations"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"L1", "[", 
      RowBox[{"z_", ",", "I1_", ",", " ", "T1_"}], "]"}], ":=", 
     RowBox[{"L10", " ", "+", " ", 
      RowBox[{"L1z", "*", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "La1"}], "*", "z"}], "]"}]}], "+", 
      RowBox[{"L1I", "*", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "Lb1"}], "*", "I1"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"L2", "[", 
      RowBox[{"z_", ",", "I2_", ",", " ", "T2_"}], "]"}], ":=", 
     RowBox[{"L20", " ", "+", " ", 
      RowBox[{"L2z", "*", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "La2"}], "*", 
         RowBox[{"(", 
          RowBox[{"H", " ", "-", " ", 
           RowBox[{"2", "*", "r"}], "-", "z"}], ")"}]}], "]"}]}], "+", 
      RowBox[{"L2I", "*", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "Lb2"}], "*", "I2"}], "]"}]}]}]}], ";"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{
  3.936597871773133*^9, {3.936598526628757*^9, 3.9365985325874596`*^9}, {
   3.9365995622569046`*^9, 3.936599562850706*^9}, {3.936600528325733*^9, 
   3.936600536982925*^9}, {3.936600688882805*^9, 3.936600691524116*^9}, 
   3.936614282674089*^9, 3.93661496537577*^9, {3.938856129818754*^9, 
   3.938856132796219*^9}, {3.9388569526405144`*^9, 3.938856999926496*^9}, {
   3.938857704394308*^9, 3.9388577060662117`*^9}, {3.938950995522119*^9, 
   3.9389510264590664`*^9}, {3.938951080337967*^9, 3.938951106659216*^9}, {
   3.939124901152687*^9, 3.9391249108716946`*^9}},
 CellLabel->
  "In[226]:=",ExpressionUUID->"efc8e544-26f7-a648-b555-6eb39756739f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", 
   RowBox[{"Resistance", " ", "equations"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"R1", "[", " ", 
      RowBox[{"I1_", ",", " ", "T1_"}], "]"}], ":=", 
     RowBox[{"R10", " ", "+", " ", 
      RowBox[{"R2I", "*", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "Ra1"}], "*", "I1"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"R2", "[", " ", 
      RowBox[{"I2_", ",", " ", "T2_"}], "]"}], ":=", 
     RowBox[{"R20", " ", "+", " ", 
      RowBox[{"R2I", "*", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "Ra2"}], "*", "I2"}], "]"}]}]}]}], ";"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.938856113875708*^9, 3.938856132796219*^9}, {
  3.938856886603901*^9, 3.938856904261266*^9}, {3.938857016259556*^9, 
  3.93885702150626*^9}, {3.9391248082250175`*^9, 3.9391248351382103`*^9}, {
  3.9391248927982235`*^9, 3.939124893745695*^9}},
 CellLabel->
  "In[227]:=",ExpressionUUID->"fcd59bfb-8888-8e4c-a0a4-d093d0ffa556"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"MagLev", " ", "Lagrangian", " ", "components"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"DOFs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"z", "[", "t", "]"}], ",", " ", 
       RowBox[{"q1", "[", "t", "]"}], ",", " ", 
       RowBox[{"q2", "[", "t", "]"}]}], "}"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T", "=", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"+", " ", "1"}], "/", "2"}], " ", "m", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"z", "'"}], "[", "t", "]"}], "^", "2"}]}], " ", 
       "\[IndentingNewLine]", "+", " ", 
       RowBox[{
        RowBox[{"1", "/", "2"}], " ", 
        RowBox[{"L1", "[", 
         RowBox[{
          RowBox[{"z", "[", "t", "]"}], ",", 
          RowBox[{
           RowBox[{"q1", "'"}], "[", "t", "]"}]}], "]"}], "*", 
        RowBox[{
         RowBox[{
          RowBox[{"q1", "'"}], "[", "t", "]"}], "^", "2"}]}], 
       "\[IndentingNewLine]", "+", " ", 
       RowBox[{
        RowBox[{"1", "/", "2"}], " ", 
        RowBox[{"L2", "[", 
         RowBox[{
          RowBox[{"z", "[", "t", "]"}], ",", 
          RowBox[{
           RowBox[{"q2", "'"}], "[", "t", "]"}]}], "]"}], "*", 
        RowBox[{
         RowBox[{
          RowBox[{"q2", "'"}], "[", "t", "]"}], "^", "2"}]}]}], 
      "\[IndentingNewLine]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q", "=", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"+", " ", 
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"1", "/", "2"}], " ", "Cd", " ", "A", " ", "rho", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"z", "'"}], "[", "t", "]"}], "^", "2"}]}], ",", 
          RowBox[{
           RowBox[{"z", "'"}], "[", "t", "]"}]}], "]"}]}], 
       "\[IndentingNewLine]", "+", " ", 
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"R1", "[", 
           RowBox[{
            RowBox[{"q1", "'"}], "[", "t", "]"}], "]"}], "*", 
          RowBox[{
           RowBox[{"q1", "'"}], "[", "t", "]"}]}], ",", " ", 
         RowBox[{
          RowBox[{"q1", "'"}], "[", "t", "]"}]}], "]"}], 
       "\[IndentingNewLine]", "+", " ", 
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"R2", "[", 
           RowBox[{
            RowBox[{"q2", "'"}], "[", "t", "]"}], "]"}], "*", 
          RowBox[{
           RowBox[{"q2", "'"}], "[", "t", "]"}]}], ",", " ", 
         RowBox[{
          RowBox[{"q2", "'"}], "[", "t", "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", ")"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"U", "=", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"-", " ", "m"}], " ", "g", " ", 
        RowBox[{"z", "[", "t", "]"}]}], "\[IndentingNewLine]", "-", 
       RowBox[{
        RowBox[{"q1", "[", "t", "]"}], "*", "V1"}], "\[IndentingNewLine]", 
       "-", 
       RowBox[{
        RowBox[{"q2", "[", "t", "]"}], "*", "V2"}]}], "\[IndentingNewLine]", 
      ")"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9365919364913235`*^9, 3.936591951946863*^9}, {
   3.936591987015732*^9, 3.936591995799101*^9}, {3.9365921271031723`*^9, 
   3.936592167620302*^9}, {3.936592199406364*^9, 3.936592467447962*^9}, {
   3.936592524253733*^9, 3.936592585234764*^9}, {3.9365926456660557`*^9, 
   3.936592669814131*^9}, {3.936592751657627*^9, 3.9365928659899197`*^9}, {
   3.9365928965271587`*^9, 3.936592951571944*^9}, {3.936593137041151*^9, 
   3.9365931382755985`*^9}, {3.936593362577955*^9, 3.936593397044685*^9}, {
   3.936594001696306*^9, 3.936594014359565*^9}, 3.936594045789776*^9, {
   3.936595442718286*^9, 3.936595444124578*^9}, {3.936595555282923*^9, 
   3.936595675683733*^9}, 3.936595711402231*^9, {3.936597938089997*^9, 
   3.936597939637274*^9}, {3.938856937459692*^9, 3.938856944326288*^9}, {
   3.938857070280527*^9, 3.938857079786159*^9}, {3.939124988078516*^9, 
   3.9391250075775223`*^9}},
 CellLabel->
  "In[228]:=",ExpressionUUID->"6ee0aedd-13e0-8d49-b591-e15e1b21a0c4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"MagLev", " ", "Lagrangian", " ", "equations"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"equations", " ", "=", " ", 
     RowBox[{"LagrangianEquations", "[", 
      RowBox[{"T", ",", "Q", ",", "U", ",", "DOFs"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"equations", "=", 
     RowBox[{"equations", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x_", "[", "t", "]"}], ":>", "x"}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"equations", "=", 
     RowBox[{"equations", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"x_", "[", 
          RowBox[{"z", ",", " ", 
           RowBox[{
            RowBox[{"Derivative", "[", "1", "]"}], "[", "q1", "]"}]}], "]"}], 
         ":>", "x"}], ",", " ", 
        RowBox[{
         RowBox[{"x_", "[", 
          RowBox[{"z", ",", " ", 
           RowBox[{
            RowBox[{"Derivative", "[", "1", "]"}], "[", "q2", "]"}]}], "]"}], 
         ":>", "x"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"equations", "=", 
     RowBox[{"equations", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", "1", "]"}], "[", "q1", "]"}], ":>", 
         "I1"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", "2", "]"}], "[", "q1", "]"}], ":>", 
         RowBox[{
          RowBox[{"Derivative", "[", "1", "]"}], "[", "I1", "]"}]}]}], 
       "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"equations", "=", 
     RowBox[{"equations", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", "1", "]"}], "[", "q2", "]"}], ":>", 
         "I2"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", "2", "]"}], "[", "q2", "]"}], ":>", 
         RowBox[{
          RowBox[{"Derivative", "[", "1", "]"}], "[", "I2", "]"}]}]}], 
       "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"displayGrid", "[", 
    RowBox[{"DOFs", ",", 
     RowBox[{"displayEquations", "[", "equations", "]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9365920065076504`*^9, 3.936592039308264*^9}, {
   3.936593007005043*^9, 3.936593028580374*^9}, {3.936593084075163*^9, 
   3.936593084653223*^9}, {3.936594017385172*^9, 3.936594062130791*^9}, {
   3.936594630601005*^9, 3.936594657669876*^9}, {3.936594773580035*^9, 
   3.9365948252463436`*^9}, {3.93659491782469*^9, 3.936594923999609*^9}, {
   3.936594998975111*^9, 3.936595025784212*^9}, {3.936595062354669*^9, 
   3.9365950724815235`*^9}, {3.9365954474621487`*^9, 3.936595461715292*^9}, {
   3.9365968780472603`*^9, 3.936596902229606*^9}, {3.93659694207382*^9, 
   3.936597023632751*^9}, {3.936597275872721*^9, 3.936597278669983*^9}, {
   3.9365981490924034`*^9, 3.9365982366779766`*^9}, {3.936598343638349*^9, 
   3.9365983504266644`*^9}, {3.9366006007019577`*^9, 3.936600672464863*^9}, {
   3.936600993635717*^9, 3.936601043161087*^9}, {3.936601149442604*^9, 
   3.9366011587542*^9}, {3.936614329376028*^9, 3.936614333583917*^9}, 
   3.936614860422886*^9, {3.936616222464323*^9, 3.936616232090637*^9}, {
   3.938856066340015*^9, 3.9388560744553223`*^9}, {3.939125341491171*^9, 
   3.939125387365429*^9}, {3.9391258317872105`*^9, 3.9391258710263405`*^9}, {
   3.9391260761671753`*^9, 3.939126109660948*^9}, {3.9391262032742043`*^9, 
   3.939126229394203*^9}, {3.9391275001829796`*^9, 3.9391275005579777`*^9}},
 CellLabel->
  "In[240]:=",ExpressionUUID->"fbd03d83-f98b-804d-b49c-70ee08c2cd9d"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["Null", "5"], " ", 
  TagBox[GridBox[{
     {
      RowBox[{"z", "[", "t", "]"}], 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", "g"}], " ", "m"}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", "A", " ", "Cd", " ", "rho", " ", 
         SuperscriptBox[
          OverscriptBox["z", "."], "2"]}], "+", 
        RowBox[{"m", " ", 
         OverscriptBox["z", "\[DoubleDot]"]}], "-", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         SuperscriptBox["I1", "2"], " ", 
         SuperscriptBox["L1", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None]}], "-", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         SuperscriptBox["I2", "2"], " ", 
         SuperscriptBox["L2", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None]}]}], "\[Equal]", "0"}]},
     {
      RowBox[{"q1", "[", "t", "]"}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "V1"}], "+", 
        RowBox[{"L1", " ", 
         OverscriptBox["I1", "."]}], "+", 
        RowBox[{"I1", " ", 
         RowBox[{"R1", "[", "I1", "]"}]}], "+", 
        RowBox[{"I1", " ", 
         OverscriptBox["I1", "."], " ", 
         SuperscriptBox["L1", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None]}], "+", 
        RowBox[{"I1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            OverscriptBox["I1", "."], " ", 
            SuperscriptBox["L1", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None]}], "+", 
           RowBox[{
            OverscriptBox["z", "."], " ", 
            SuperscriptBox["L1", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None]}]}], ")"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         SuperscriptBox["I1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            OverscriptBox["I1", "."], " ", 
            SuperscriptBox["L1", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "2"}], ")"}],
              Derivative],
             MultilineFunction->None]}], "+", 
           RowBox[{
            OverscriptBox["z", "."], " ", 
            SuperscriptBox["L1", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None]}]}], ")"}]}]}], "\[Equal]", "0"}]},
     {
      RowBox[{"q2", "[", "t", "]"}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "V2"}], "+", 
        RowBox[{"L2", " ", 
         OverscriptBox["I2", "."]}], "+", 
        RowBox[{"I2", " ", 
         RowBox[{"R2", "[", "I2", "]"}]}], "+", 
        RowBox[{"I2", " ", 
         OverscriptBox["I2", "."], " ", 
         SuperscriptBox["L2", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None]}], "+", 
        RowBox[{"I2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            OverscriptBox["I2", "."], " ", 
            SuperscriptBox["L2", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None]}], "+", 
           RowBox[{
            OverscriptBox["z", "."], " ", 
            SuperscriptBox["L2", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None]}]}], ")"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         SuperscriptBox["I2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            OverscriptBox["I2", "."], " ", 
            SuperscriptBox["L2", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "2"}], ")"}],
              Derivative],
             MultilineFunction->None]}], "+", 
           RowBox[{
            OverscriptBox["z", "."], " ", 
            SuperscriptBox["L2", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None]}]}], ")"}]}]}], "\[Equal]", "0"}]}
    },
    AutoDelete->False,
    GridBoxAlignment->{"Columns" -> {{Left}}},
    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
    GridBoxSpacings->{"Columns" -> {{2}}, "Rows" -> {{2}}}],
   "Grid"]}]], "Output",
 CellChangeTimes->{
  3.939125388398428*^9, {3.9391258531161976`*^9, 3.9391258716823425`*^9}, {
   3.9391260852271824`*^9, 3.9391261099599476`*^9}, {3.9391262256871567`*^9, 
   3.9391262303121796`*^9}, {3.9391274837762146`*^9, 3.9391275017770348`*^9}},
 CellLabel->
  "Out[240]=",ExpressionUUID->"9099b945-d901-1244-95d9-fc29fd7fae50"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"equations", "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", 
    RowBox[{
     RowBox[{"Derivative", "[", "1", "]"}], "[", "I2", "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.939125207560278*^9, 3.9391252587844315`*^9}},
 CellLabel->
  "In[233]:=",ExpressionUUID->"cfbc8393-ebce-194a-aa04-9bd40b89ec38"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "V1"}], "+", 
   RowBox[{"I1", " ", 
    RowBox[{"R1", "[", "I1", "]"}]}], "+", 
   RowBox[{"L1", " ", 
    SuperscriptBox["I1", "\[Prime]",
     MultilineFunction->None]}], "+", 
   RowBox[{"I1", " ", 
    SuperscriptBox["I1", "\[Prime]",
     MultilineFunction->None], " ", 
    SuperscriptBox["L1", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None]}], "+", 
   RowBox[{"I1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["I1", "\[Prime]",
        MultilineFunction->None], " ", 
       SuperscriptBox["L1", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None]}], "+", 
      RowBox[{
       SuperscriptBox["z", "\[Prime]",
        MultilineFunction->None], " ", 
       SuperscriptBox["L1", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None]}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    SuperscriptBox["I1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["I1", "\[Prime]",
        MultilineFunction->None], " ", 
       SuperscriptBox["L1", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "2"}], ")"}],
         Derivative],
        MultilineFunction->None]}], "+", 
      RowBox[{
       SuperscriptBox["z", "\[Prime]",
        MultilineFunction->None], " ", 
       SuperscriptBox["L1", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None]}]}], ")"}]}]}], "\[Equal]", "0"}]], "Output",
 CellChangeTimes->{{3.93912523426029*^9, 3.9391253193318424`*^9}, 
   3.9391274838230896`*^9},
 CellLabel->
  "Out[233]=",ExpressionUUID->"fb432928-dafb-4948-9dbd-7f0e5e874ee8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Negletting", " ", "drag", " ", "force"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"equations", "[", 
     RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"equations", "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", 
     RowBox[{
      FractionBox["1", "2"], "A", " ", "Cd", " ", "rho", " ", 
      SuperscriptBox[
       RowBox[{
        RowBox[{"Derivative", "[", "1", "]"}], "[", "z", "]"}], "2"]}]}]}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.93885873868104*^9, 3.9388587833323193`*^9}, {
  3.938858833712799*^9, 3.93885884508922*^9}, {3.9388599346926327`*^9, 
  3.9388599467675114`*^9}},
 CellLabel->
  "In[234]:=",ExpressionUUID->"66fee937-770b-0c40-831d-02886f4bee2e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", 
   RowBox[{
   "Define", " ", "the", " ", "equilibrium", " ", "point", " ", "around", " ",
     "which", " ", "to", " ", "linearize"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"equilibriumValues", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"z", "->", "z0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"I1", "->", "I10"}], ",", "\[IndentingNewLine]", 
      RowBox[{"I2", "->", "I20"}], ",", "\[IndentingNewLine]", 
      RowBox[{"T1", "->", "T10"}], ",", "\[IndentingNewLine]", 
      RowBox[{"T2", "->", "T20"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", "1", "]"}], "[", "z", "]"}], "->", "0"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", "1", "]"}], "[", "I1", "]"}], "->", "0"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", "1", "]"}], "[", "I2", "]"}], "->", "0"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", "1", "]"}], "[", "T1", "]"}], "->", "0"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", "1", "]"}], "[", "T2", "]"}], "->", 
       "0"}]}], "\[IndentingNewLine]", "}"}]}], ";", "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Linearize", " ", "each", " ", "equation", " ", "using", " ", "a", " ", 
     "Taylor", " ", "expansion", " ", "around", " ", "the", " ", 
     "equilibrium", " ", "values"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"linearizedEquations", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"Series", "[", 
        RowBox[{"#", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"z", ",", "z0", ",", "1"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"I1", ",", "I10", ",", "1"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"I2", ",", "I20", ",", "1"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"T1", ",", "T10", ",", "1"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"T2", ",", "T20", ",", "1"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Derivative", "[", "1", "]"}], "[", "z", "]"}], ",", "0", 
           ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Derivative", "[", "1", "]"}], "[", "I1", "]"}], ",", "0",
            ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Derivative", "[", "1", "]"}], "[", "I2", "]"}], ",", "0",
            ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Derivative", "[", "1", "]"}], "[", "T1", "]"}], ",", "0",
            ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Derivative", "[", "1", "]"}], "[", "T2", "]"}], ",", "0",
            ",", "1"}], "}"}]}], "]"}], "]"}], "&"}], "/@", "equations"}]}], 
   ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"linearizedEquations", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"taylor", "[", 
      RowBox[{"zeq_", ",", "veq_", ",", " ", "I1eq_", ",", " ", "I2eq_"}], 
      "]"}]}], ":=", 
    RowBox[{
     RowBox[{"Normal", "@", 
      RowBox[{"Series", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"equations", "/.", " ", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"z", ",", " ", "v", ",", " ", "I1", ",", " ", "I2"}], 
            "}"}], "->", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", " ", "0", ",", " ", "0"}], "}"}], 
            "+", 
            RowBox[{"t", " ", 
             RowBox[{"{", 
              RowBox[{"zeq", ",", "veq", ",", " ", "I1eq", ",", " ", "I2eq"}],
               "}"}]}]}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "/.", " ", 
     RowBox[{"t", "->", "1"}]}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{
  3.938858193735277*^9, {3.938858233783107*^9, 3.938858342854772*^9}, {
   3.938858472174236*^9, 3.938858481337522*^9}, {3.938858543219738*^9, 
   3.938858550752304*^9}, {3.938858589280077*^9, 3.938858593345337*^9}, {
   3.9388586240189457`*^9, 3.938858636140518*^9}, {3.938859019079797*^9, 
   3.938859113912172*^9}, {3.938859144263897*^9, 3.938859215538362*^9}, {
   3.938859270141115*^9, 3.9388592708863087`*^9}, {3.938859788017638*^9, 
   3.938859859913479*^9}, {3.938859898418611*^9, 3.938859919207323*^9}, {
   3.9388601578671417`*^9, 3.938860347957468*^9}},
 CellLabel->
  "In[235]:=",ExpressionUUID->"514ebc40-0cd6-7848-bb45-09ecddabecf2"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", 
   RowBox[{"Linearization", " ", "with", " ", "Taylor"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Normal", "@", 
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{"/.", " ", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"u", ",", "v"}], "}"}], "\[Minus]"}], ">", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "+", 
            RowBox[{"t", " ", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}]}]}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "taylorOrder"}], "}"}]}], "]"}]}], "/.", 
     " ", 
     RowBox[{
      RowBox[{"t", "\[Minus]"}], ">", "1"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ResourceFunction", "[", "\"\<TaylorPolynomial\>\"", "]"}], "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x0", ",", "y0"}], "}"}], ",", "2"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.938857806348728*^9, 3.938857819905485*^9}, {
   3.93885787018696*^9, 3.938857875340666*^9}, {3.9388579068060303`*^9, 
   3.9388579382703533`*^9}, 3.938858164289276*^9},
 CellLabel->
  "In[236]:=",ExpressionUUID->"138231b6-cebb-2f41-a287-cd6b6249f36e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", 
   RowBox[{
   "Setting", " ", "parameters", " ", "for", " ", "the", " ", "system"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"g", "=", "9.81"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"rho", "=", "1.21"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Cd", "=", "0.45"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R10", "=", 
     RowBox[{"3.772320", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "1"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"R20", "=", 
     RowBox[{"3.622267", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "1"}]}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"L10", "=", 
     RowBox[{"1.017205", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "2"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"L20", "=", 
     RowBox[{"1.012970", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "2"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"a1", "=", 
     RowBox[{"1.795948", "*", 
      RowBox[{"10", "^", "2"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"a2", "=", 
     RowBox[{"1.795948", "*", 
      RowBox[{"10", "^", "2"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"L1z", "=", 
     RowBox[{"5.448902", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "2"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"L2z", "=", 
     RowBox[{"5.448902", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m", "=", 
     RowBox[{"60.54", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "3"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"H", "=", 
     RowBox[{"98.00", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "3"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"r", "=", 
     RowBox[{
      RowBox[{"61.25", "/", "2"}], "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "3"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A", "=", 
     RowBox[{"Pi", "*", 
      RowBox[{"r", "^", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ki", "=", 
     RowBox[{"1", "/", "R10"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ci", "=", 
     RowBox[{"2.383122", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "2"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"fiP1", "=", 
     RowBox[{"1.4142", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "4"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"fiP2", "=", 
     RowBox[{"4.5626", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "3"}]}]}]}], ";"}]}], "\[IndentingNewLine]", 
  "*)"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.936601804905981*^9, 3.9366018879865265`*^9}, {
   3.936601934649628*^9, 3.936601935884321*^9}, {3.936601975393217*^9, 
   3.9366019848416986`*^9}, {3.936603085167267*^9, 3.93660309155904*^9}, {
   3.938857183104572*^9, 3.9388572573586864`*^9}, {3.938857319699276*^9, 
   3.938857355360359*^9}, {3.9388574297242565`*^9, 3.938857580439495*^9}, 
   3.938857630150711*^9},
 CellLabel->
  "In[237]:=",ExpressionUUID->"b65e216d-bd52-fa4d-8fd8-cb2472985888"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"displayGrid", "[", 
   RowBox[{"DOFs", ",", 
    RowBox[{"displayEquations", "[", 
     RowBox[{"SetPrecision", "[", 
      RowBox[{"equations", ",", "2"}], "]"}], "]"}]}], "]"}], "*)"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.936601906757702*^9, 3.936601918827339*^9}, {
  3.936602128742161*^9, 3.936602152170595*^9}, {3.936602188761274*^9, 
  3.936602196684303*^9}},
 CellLabel->
  "In[238]:=",ExpressionUUID->"b2e90cb2-ebba-5347-abe9-0e6e10aa8c3b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", 
   RowBox[{"Find", " ", "equilibrium", " ", "point"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"equilibriumEquations", "=", 
      RowBox[{"equations", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", "1", "]"}], "[", "x_", "]"}], "->", 
          "0"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", "2", "]"}], "[", "x_", "]"}], "->", 
          "0"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"equilibriumEquations", "=", 
      RowBox[{"equilibriumEquations", "/.", " ", 
       RowBox[{"{", 
        RowBox[{"z", "->", " ", "0.01"}], "}"}]}]}], ";"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"equilibriumPositions", "=", 
      RowBox[{"Solve", "[", 
       RowBox[{"equilibriumEquations", " ", ",", 
        RowBox[{"{", 
         RowBox[{"i1", ",", " ", "i2", ",", " ", "V1", ",", " ", "V2"}], 
         "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
    "equilibriumPositions"}], "/.", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", " ", "->", " ", 
      RowBox[{"1", "/", "0.0058231"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"L", " ", "->", " ", "0.017521"}], ",", "\[IndentingNewLine]", 
     RowBox[{"R", " ", "->", " ", "250"}], ",", "\[IndentingNewLine]", 
     RowBox[{"d", " ", "->", " ", "0.016"}], ",", "\[IndentingNewLine]", 
     RowBox[{"m", "->", "0.615"}], ",", "\[IndentingNewLine]", 
     RowBox[{"g", "->", "9.81"}]}], "\[IndentingNewLine]", "}"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.9365967892018547`*^9, 3.936596810409429*^9}, {
   3.936596860361841*^9, 3.936596860486841*^9}, {3.9365970455618095`*^9, 
   3.936597051373686*^9}, 3.9365978855268574`*^9, {3.936598274424385*^9, 
   3.936598312229977*^9}, {3.936598393385902*^9, 3.936598416120603*^9}, {
   3.936598464332506*^9, 3.9365984669921513`*^9}, {3.936598866953274*^9, 
   3.9365989005374546`*^9}, {3.936599633987591*^9, 3.9365996541989517`*^9}, {
   3.936599721810007*^9, 3.936599745229791*^9}, {3.936599783289015*^9, 
   3.936599805250601*^9}, {3.936599919453699*^9, 3.936599934551101*^9}, 
   3.936600369182207*^9, {3.936601067759136*^9, 3.936601083606325*^9}, {
   3.936601192808002*^9, 3.936601197417774*^9}, {3.936601468218227*^9, 
   3.9366014732479973`*^9}, {3.936601663317581*^9, 3.936601666182978*^9}, {
   3.936602025386463*^9, 3.936602056413641*^9}, {3.936602165275818*^9, 
   3.936602176806528*^9}, {3.936602229227455*^9, 3.936602280306122*^9}, {
   3.9366023469740734`*^9, 3.9366023661252327`*^9}, {3.936602406102154*^9, 
   3.936602417182117*^9}, 3.936603104165191*^9, {3.936603141840391*^9, 
   3.9366031664943943`*^9}, {3.936603316099327*^9, 3.936603382978111*^9}},
 CellLabel->
  "In[239]:=",ExpressionUUID->"4a2746ae-6295-7548-99af-c728138e9f33"]
},
WindowSize->{1440, 747.75},
WindowMargins->{{-6, Automatic}, {Automatic, -6}},
DockedCells->{},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"14.0 for Microsoft Windows (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"684fcddd-8ee9-8648-b786-9468b659fe76"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1291, 25, 124, "Input",ExpressionUUID->"c60eeeea-1f42-da4b-ad85-56602cc04086"],
Cell[1852, 47, 1806, 48, 124, "Input",ExpressionUUID->"9761a00d-313e-ad4d-8777-6aab98ffa736"],
Cell[3661, 97, 3149, 78, 88, "Input",ExpressionUUID->"7e5f123e-8ee5-eb4a-ba72-1e70e4cb4e67"],
Cell[6813, 177, 1803, 46, 67, "Input",ExpressionUUID->"efc8e544-26f7-a648-b555-6eb39756739f"],
Cell[8619, 225, 1094, 30, 67, "Input",ExpressionUUID->"fcd59bfb-8888-8e4c-a0a4-d093d0ffa556"],
Cell[9716, 257, 4275, 112, 390, "Input",ExpressionUUID->"6ee0aedd-13e0-8d49-b591-e15e1b21a0c4"],
Cell[CellGroupData[{
Cell[14016, 373, 3663, 88, 155, "Input",ExpressionUUID->"fbd03d83-f98b-804d-b49c-70ee08c2cd9d"],
Cell[17682, 463, 5341, 160, 156, "Output",ExpressionUUID->"9099b945-d901-1244-95d9-fc29fd7fae50"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23060, 628, 410, 11, 48, "Input",ExpressionUUID->"cfbc8393-ebce-194a-aa04-9bd40b89ec38"],
Cell[23473, 641, 1952, 65, 47, "Output",ExpressionUUID->"fb432928-dafb-4948-9dbd-7f0e5e874ee8"]
}, Open  ]],
Cell[25440, 709, 807, 22, 53, "Input",ExpressionUUID->"66fee937-770b-0c40-831d-02886f4bee2e"],
Cell[26250, 733, 5222, 127, 581, "Input",ExpressionUUID->"514ebc40-0cd6-7848-bb45-09ecddabecf2"],
Cell[31475, 862, 1456, 41, 67, "Input",ExpressionUUID->"138231b6-cebb-2f41-a287-cd6b6249f36e"],
Cell[CellGroupData[{
Cell[32956, 907, 3231, 100, 466, "Input",ExpressionUUID->"b65e216d-bd52-fa4d-8fd8-cb2472985888",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[36190, 1009, 540, 12, 28, "Input",ExpressionUUID->"b2e90cb2-ebba-5347-abe9-0e6e10aa8c3b",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Open  ]],
Cell[36745, 1024, 2937, 61, 268, "Input",ExpressionUUID->"4a2746ae-6295-7548-99af-c728138e9f33"]
}
]
*)

