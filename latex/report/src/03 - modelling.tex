\section{Modelling}
\label{sec:modelling}

The \acrshort{mls} is a complex system that can be divided into:

\begin{itemize}
    \item \textbf{Electromagnetic subsystem}: it takes into account all the electrical components going from the power supply to the electromagnets themselves, and so the generation of the magnetic field by the coils;
    \item \textbf{Mechanical subsystem}: it takes into account the dynamics of the ball and the forces acting on it, including the electromagnetic forces generated by the magnetic field.
\end{itemize}

Due to the presence of the ball that moves inside a magnetic field, a complex connection between the two subsystems that goes beyond the simple force balance exists.
For this reason, it's almost impossible to derive a complete model without considering both subsystems at the same time.

In Figure \ref{fig:system_model}, a schematic representation of all the components of the system and the forces acting on it is shown.
Instead, in Table \ref{tab:components} a brief description of the components is provided.

\begin{figure}[H]

    \begin{minipage}{0.40\textwidth}

        \centering

        \begin{tikzpicture}[european voltages]

            \def\radius{0.3}

            % Upper circuit
            \node at (-1.0, 3.5) {$T_1$};
            \draw (-3, 3.5) node [right] {$+$}
            to [short] ++(0, -1)
            to [R, l^=$R_1$, resistors/zigs=6] ++(2, 0)
            to [variable cute inductor, i>^=$I_1$, l=$L_1$] ++(2, 0)
            to [short] ++(0, +1) node [right] {$-$};

            % Reference system
            \draw[|->] (-1.0, +2.5) -- ++(0, -3) node[left] {$z$, $\dot{z}$, $\ddot{z}$};

            % Ball
            \filldraw[fill=gray, draw=black] (0, 0) circle (\radius);

            % Upward forces
            \draw[thick, ->] (-0.1, +\radius) -- ++(0, +1.5) node[right] {$F_{\text{em1}}$};
            \draw[thick, ->] (+0.0, +\radius) -- ++(0, +1.0) node[right] {$F_{\text{in}}$};
            \draw[thick, ->] (+0.1, +\radius) -- ++(0, +0.5) node[right] {$F_{\text{d}}$};

            % Downward forces
            \draw[thick, ->] (+0.1, -\radius) -- ++(0, -0.5) node[right] {$F_{\text{g}}$};
            \draw[thick, ->] (-0.1, -\radius) -- ++(0, -1.0) node[right] {$F_{\text{em2}}$};

            % Lower circuit
            \node at (-1.0, -3.0) {$T_2$};
            \draw (-3, -3) node [right] {$+$}
            to [short] ++(0, +1)
            to [R, l_=$R_2$, resistors/zigs=6] ++(2, 0)
            to [variable cute inductor, i>_=$I_2$, l_=$L_2$] ++(2, 0)
            to [short] ++(0, -1) node [right] {$-$};

        \end{tikzpicture}

    \end{minipage}
    %
    \hfill
    %
    \begin{minipage}{0.55\textwidth}

        \centering

        \begin{tabular}{|c|l|c|}
            \hline
            \textbf{Name}      & \textbf{Description}               & \textbf{Units} \\
            \hline
            $F_{\text{g}}$     & Gravitational force                & N              \\
            $F_{\text{in}}$    & Inertial force                     & N              \\
            $F_{\text{d}}$     & Drag force                         & N              \\
            $F_{\text{em1,2}}$ & Electromagnetic forces             & N              \\
            \hline
            $R_{1,2}$          & Resistances of the coils           & $\Omega$       \\
            $L_{1,2}$          & Inductances of the coils           & H              \\
            $I_{1,2}$          & Currents flowing through the coils & A              \\
            $V_{1,2}$          & Voltages applied to the coils      & V              \\
            $T_{1,2}$          & Temperatures of the coils          & $^\circ C$     \\
            \hline
        \end{tabular}

    \end{minipage}

    \caption{Schematic representation of the \acrshort{mls} system and description of its components.}
    \label{fig:system_model}
    \label{tab:components}

\end{figure}


In the following sections, we will derive the equations that governs the \acrshort{mls} system, adopting an energetic approach that starts from the energy conservation principle.

\input{src/03.1 - mathematical_model.tex}
\input{src/03.2 - model_linearization.tex}
\input{src/03.3 - state_space_representation.tex}
\input{src/03.4 - single_coil_configuration.tex}